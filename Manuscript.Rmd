---
title: "Missing The Point"
author: "Hanne Oberman"
date: "7-9-2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Missing The Point

## Intro

- Missing data has to be accommodated, usually filled in

- Filling in is algorithmic, which relies on convergence

- Diagnosing convergence is difficult, both visually and diagnostically

- In this paper we explore diagnostic methods for MICE, and show which parameter has the best performance --> most informative about convergence 


## Identifying non-convergence

- What does non-convergence look like? What are the consequences?

- 


## Simulation

- 3x3 missingness conditions: MCAR, MAR, MNAR + 5, 50, 95% of cases incomplete

- outcomes: estimated regression coefficient, CIW, coverage, R2 --> multivariate is key, because univariate convergence does not guarantee multivariate convergence

- convergence parameters: chain means, chain variances, scientific parameter, lambda

- diagnostics: rhat, ac

## Some results

```{r echo=FALSE}
load("~/MissingThePoint/Data/results.Rdata")
results %>%
  ggplot() +
  geom_hline(yintercept = 0.3334) +
  geom_point(aes(x=it, y=est, color = mech, shape = as.factor(p))) +
  geom_line(aes(x=it, y=est, color = mech, linetype = as.factor(p))) +
  theme_classic()


```

Bias in estimate depends mostly on the amount of missingness (less info to estimate the relation??), but overall MNAR performs the worst, which is stable after it=5.

```{r}
results %>%
  ggplot() +
  geom_hline(yintercept = 0.95) +
  geom_point(aes(x=it, y=cov, color = mech, shape = as.factor(p))) +
  geom_line(aes(x=it, y=cov, color = mech, linetype = as.factor(p))) +
  theme_classic()


```

Cov is more or less fine, except for MNAR with only 0.05% incomplete cases --> due to bias in the estimate in combination with very narrow CI (see CIW!). However, all stable after it=3??

```{r}
results %>%
  ggplot() +
  geom_point(aes(x=it, y=CIW, color = mech, shape = as.factor(p))) +
  geom_line(aes(x=it, y=CIW, color = mech, linetype = as.factor(p))) +
  theme_classic()


```

CIW clearly determined by the proportion of incomplete cases. Worst for p=0.95, then stable after it 7.

```{r}
results %>%
  ggplot() +
  geom_hline(yintercept = 0.2090) +
  geom_point(aes(x=it, y=rsq, color = mech, shape = as.factor(p))) +
  geom_line(aes(x=it, y=rsq, color = mech, linetype = as.factor(p))) +
  theme_classic()

```

Magnitude of the bias in R^2 perfectly follows the missingness mechanisms: least bias for MCAR, most for MNAR. Worst effect of non-convergence for p=0.95, MNAR, but stable from it=5.

```{r}
results %>%
  ggplot() +
  geom_point(aes(x=it, y=ac.max.lambda, color = mech, shape = as.factor(p))) +
  geom_line(aes(x=it, y=ac.max.lambda, color = mech, linetype = as.factor(p))) +
  theme_classic()
```


```{r}
results %>%
  ggplot() +
  geom_point(aes(x=it, y=r.hat.max.lambda, color = mech, shape = as.factor(p))) +
  geom_line(aes(x=it, y=r.hat.max.lambda, color = mech, linetype = as.factor(p))) +
  theme_classic()

```

